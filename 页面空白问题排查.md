# 🔍 页面空白问题排查指南

## ❌ 问题描述

- 运行工作流时，页面变成白色，什么都没有
- 打开工作流画布也是一片空白

## 🔍 问题原因

页面空白通常是前端 JavaScript 错误导致的，可能的原因：

1. **API 连接失败** - 前端无法连接到后端
2. **数据加载错误** - 工作流数据格式不正确
3. **React 渲染错误** - 组件渲染时出错
4. **路由问题** - 路由配置错误
5. **依赖加载失败** - 某些库未正确加载

## ✅ 排查步骤

### 步骤 1：检查浏览器控制台（最重要！）

1. **打开浏览器开发者工具**
   - 按 `F12` 或 `Cmd+Option+I`（Mac）
   - 或右键页面 → "检查" / "Inspect"

2. **查看 Console 标签**
   - 点击 **"Console"** 标签
   - **查看是否有红色错误信息**
   - 常见的错误可能包括：
     - `Failed to fetch` - API 连接失败
     - `Cannot read property 'xxx' of undefined` - 数据格式错误
     - `Uncaught Error: ...` - JavaScript 错误

3. **查看 Network 标签**
   - 点击 **"Network"** 标签
   - 刷新页面（F5）
   - **查看 API 请求是否成功**
   - 检查 `/workflows` 或其他 API 请求：
     - 如果显示红色（失败），说明 API 连接有问题
     - 如果状态码是 404、500 等，说明后端有问题

### 步骤 2：检查 API 连接

1. **检查环境变量**
   - 在浏览器 Console 中执行：
     ```javascript
     console.log(import.meta.env.VITE_API_BASE_URL)
     ```
   - 应该显示你的 Railway 后端 URL
   - 如果显示 `undefined` 或 `http://localhost:1888`，说明环境变量未正确设置

2. **测试后端连接**
   - 直接在浏览器中访问：
     ```
     https://你的railway后端URL/workflows
     ```
   - 应该返回 JSON 数据
   - 如果不能访问，说明后端有问题

### 步骤 3：检查常见错误

#### 错误 1：API 连接失败

**症状**：Console 显示 `Failed to fetch` 或 `Network Error`

**解决方法**：
1. 检查 Vercel 环境变量 `VITE_API_BASE_URL` 是否正确
2. 确认后端 URL 可以访问
3. 检查 CORS 配置（后端已配置，通常没问题）

#### 错误 2：数据格式错误

**症状**：Console 显示 `Cannot read property 'xxx' of undefined`

**解决方法**：
1. 检查后端返回的数据格式
2. 查看 Network 标签中的 API 响应
3. 确认数据是否符合前端期望的格式

#### 错误 3：React 渲染错误

**症状**：Console 显示 React 相关错误

**解决方法**：
1. 查看完整的错误堆栈信息
2. 根据错误信息定位问题代码
3. 修复代码后重新部署

## 🛠️ 快速修复方法

### 方法 1：检查并修复环境变量

如果 API 连接失败：

1. **进入 Vercel 项目设置**
   - Settings → Environment Variables
   - 确认 `VITE_API_BASE_URL` 已设置
   - 确认值是正确的 Railway 后端 URL

2. **重新部署**
   - 修改环境变量后，Vercel 会自动重新部署
   - 或手动触发重新部署

### 方法 2：检查后端状态

1. **测试后端 API**
   - 在浏览器中访问：`https://你的后端URL/workflows`
   - 应该返回 JSON 数据（可能是空数组 `[]`）

2. **检查 Railway 部署状态**
   - 访问 Railway 控制台
   - 确认服务正在运行
   - 查看部署日志是否有错误

### 方法 3：清除缓存并刷新

1. **清除浏览器缓存**
   - 按 `Cmd+Shift+R`（Mac）或 `Ctrl+Shift+R`（Windows）强制刷新
   - 或清除浏览器缓存后重新访问

2. **使用无痕模式**
   - 打开无痕/隐私模式
   - 访问你的应用
   - 看问题是否仍然存在

## 📝 调试信息收集

请提供以下信息以便进一步诊断：

1. **浏览器 Console 错误信息**
   - 打开 Console，复制所有红色错误信息

2. **Network 请求状态**
   - 打开 Network 标签
   - 查看 `/workflows` 或其他 API 请求的状态
   - 查看请求的 URL 是否正确

3. **环境变量值**
   - 在 Console 中执行：
     ```javascript
     console.log(import.meta.env.VITE_API_BASE_URL)
     ```
   - 告诉我显示的值是什么

4. **后端 URL 状态**
   - 告诉我你的后端 URL
   - 直接在浏览器中访问是否正常

## 🔧 临时解决方案

如果急需使用，可以尝试：

1. **重新部署**
   - 在 Vercel 中手动触发重新部署
   - 等待部署完成后再访问

2. **检查代码是否有语法错误**
   - 查看最近是否有代码更改
   - 确认没有引入语法错误

3. **回滚到之前可用的版本**
   - 在 Vercel Deployments 页面
   - 找到之前可用的部署
   - 点击 "..." → "Promote to Production"

## ✅ 检查清单

- [ ] 已打开浏览器开发者工具（F12）
- [ ] 已查看 Console 标签的错误信息
- [ ] 已查看 Network 标签的 API 请求状态
- [ ] 已检查环境变量 `VITE_API_BASE_URL` 是否正确
- [ ] 已测试后端 URL 是否可以访问
- [ ] 已尝试清除缓存并刷新
- [ ] 已检查 Vercel 和 Railway 的部署状态

---

**最重要的一步：打开浏览器 Console（F12），查看错误信息，这是诊断问题的关键！** 🔍
